# MPServerless SDK

[![NPM](https://nodei.co/npm/@ant-basement/miniprogram-sdk.png)](https://nodei.co/npm/@ant-basement/miniprogram-sdk/)

MPServerless SDK

## Getting Started

> npm install --save @alicloud/mpserverless-sdk

## Usage

```js
const MPServerless = require('@alicloud/mpserverless-sdk');
const mpServerless = new MPServerless({
  uploadFile: my.uploadFile,
  request: my.request,
  getAuthCode: my.getAuthCode,
}, {
  appId: 'xxx', // 小程序应用标识
  spaceId: 'xxx', // 服务空间标识
  clientSecret: 'xxx', // 服务空间 secret key
  endpoint: 'https://webgw.basement.nlark.com' // 服务空间地址，从小程序 serverless 控制台处获得
});

mpServerless.user.getInfo().then(res => {
  console.log('user info', res);
});
mpServerless.db.collection('task').find().then(res => {
  console.log('task list', res.result);
});
mpServerless.function.invoke('sayHello', { name: 'angela' }).then(res => {
  console.log(res.result + ' says angela');
});

my.chooseImage({
  chooseImage: 1,
  success: res => {
    const path = res.apFilePaths[0];
    const that = this;
    my.getImageInfo({
      src: path,
      success: function(res) {
        const options = {
          filePath: path,
          extension: res.type,
          headers: {
            contentDisposition: 'inline',
          },
        };
        app.mpServerless.file.uploadFile(options).then((image) => {
          that.setData({
            iconUrl: image.fileUrl,
          });
        }).catch(console.error);
      },
      fail: function(err) {
        console.log(err);
      }
    });
  },
});
```
